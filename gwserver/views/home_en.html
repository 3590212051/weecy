	{{template "header_en"}}
		<title>Go Walker - Go API documentation and project view</title>
	</head>

	<body id="body" style="font-family: Microsoft Yahei; font-size: 13px;">
		{{template "navbar_en" .}}
		<div class="container" style="width: 1000px;">
			<div id="main_content" class="row">
				<div style="margin-left: 20px;">
					{{template "alert_en" .}}
                    <div class="page-header">
                        <h2 style="margin-top: 0">
                            Search for Go projects.
                            <small>Find a cup of source code.</small>
                            <g:plusone></g:plusone>
                        </h2>

                        <form action="/">
                            <div class="input-append">
                                <input autocomplete="off" class="span6" type="text"
                                       placeholder="Type import path to add and view or use keywords to search" name="q"
                                       data-source="[{{str2html .GoReposSrc}}]" data-items="10" data-provide="typeahead"></input>
                                <button class="btn" type="submit"><i class="icon-search"></i> Go!</button>
                            </div>
                        </form>
                    </div>
				</div>

				<div id="homeleft" class="span6 homeleft">
					<div>
						<h4>What is this?</h4>
						<p>
							Go Walker Server generates <a target="_blank" href="http://golang.org/">Go</a> projects API documentation and
							<button class="btn feature" title=""
							        data-content="Hacker view allows you study a Go project without any installation, and with awesome features like 'jump to definition' and 'find usage'."
							        data-placement="top" data-toggle="popover" data-original-title="Hacker View">Hacker View</button>
							on the fly for the projects on <b><a target="_blank" href="https://bitbucket.org/">Bitbucket</a></b>, <b><a target="_blank" href="https://github.com/">GitHub</a></b>, <b><a target="_blank" href="http://code.google.com/">Google Code</a></b>, <b><a target="_blank" href="https://launchpad.net/">Launchpad</a></b>, <b><a target="_blank" href="https://gitcafe.com/">GitCafe</a></b>  and <b><a target="_blank" href="http://git.oschina.net/">Git @ OSC</a></b>.
						</p>

						<p>
							Awesome features
                            <button class="btn feature" title=""
                                    data-content="View function and method code with nice highlight in the same page, reduce rake up space and do more work at the same time."
                                    data-placement="bottom" data-toggle="popover" data-original-title="Code View">Code View</button>

                            <button class="btn feature" title=""
                                    data-content="Quick jump to functions, methods and types from imported packages, reduce time to find."
                                    data-placement="top" data-toggle="popover" data-original-title="Link Jump">Link Jump</button>

                            <button class="btn feature" title=""
                                    data-content="Add examples for your favorite projects through Github Gist." data-placement="bottom"
                                    data-toggle="popover" data-original-title="Add Example">Add Example</button>

                            <button class="btn feature" title=""
                                    data-content="Don't worry if you use old version of a project, now you can view documentation by its Tags!"
                                    data-placement="right" data-toggle="popover" data-original-title="View by Tag">Doc Tag</button>

                            and <a target="_blank" href="https://github.com/Unknwon/gowalker/blob/master/docs/Features.md">More</a>.
						</p>

                        <p class="text-success">
                            Please read the <a href="/about">About Page</a> for information about hacking with Go Walker and more.
                        </p>
					</div>

					<div class="tab-content">
					    <div id="global_history" class="tab-pane fade active in">
					        <h4>
					            What all the people are looking at.
					            <a href="#user_history" class="btn btn-inverse" data-toggle="tab">Local history</a>
					            <small class="text-info">Hover link to see more.</small>
					        </h4>

					        <table name="recent_table" class="table table-bordered table-hover">
					            <thead>
					                <tr>
					                    <th>Import Path</th>
					                    <th>Viewd Time(Local)</th>
					                </tr>
					            </thead>

					            <tbody>
						            {{range .GlobalHistory}}
						            {{template "history_table" .}}
						            {{end}}
					            </tbody>
					        </table>
					    </div>

					    <div id="user_history" class="tab-pane fade">
					        <h4>
					            What you have been looking at.
					            <a href="#global_history" class="btn btn-inverse" data-toggle="tab">Global history</a>
					            <small class="text-info">Hover link to see more.</small>
					        </h4>

					        <table name="recent_table" class="table table-bordered table-hover">
					            <thead>
					                <tr>
					                    <th>Import Path</th>
					                    <th>Viewd Time(Local)</th>
					                </tr>
					            </thead>

					            <tbody>
						            {{range .UserHistory}}
						            {{template "history_table" .}}
						            {{end}}
					            </tbody>
					        </table>
					    </div>
					    {{template "convert_js"}}
					</div>
				</div>
			</div>
		</div>
        {{template "footer_en" .}}
	</body>
</html>

{{define "history_table"}}
<tr>
    <td>
        <a title="{{.Synopsis}}" href="/{{.Path}}">{{.Path}}</a>

        {{if .IsGoRepo}}
        <span class="label label-info">Standard</span>
        {{end}}
    </td>

    <td>{{.ViewedTime}}</td>
</tr>
{{end}}

{{define "convert_js"}}
<script>
    (function () {
        var tables = document.getElementsByName("recent_table");
        var now = new Date();
        for (var n = 0; n < tables.length; n++) {
            var table = tables[n];
            var items = table.getElementsByTagName("tr");
            for (var i = 1; i < items.length; i++) {
                // Limit length.
                var s = table.rows[i].cells[0].getElementsByTagName("a")[0];
                if (s.innerHTML.length > 45) {
                    s.innerHTML = "..." + s.innerHTML.substr(s.innerHTML.length - 42);
                }
                // Convert timestamp to local time.
                var t = parseInt(table.rows[i].cells[1].innerHTML);
                var d = new Date(t * 1000);
                table.rows[i].cells[1].innerHTML = d.toLocaleString();
            }
        }
    })();
</script>
{{end}}